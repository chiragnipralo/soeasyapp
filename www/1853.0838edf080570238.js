"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1853],{1853:(x,A,l)=>{l.d(A,{k:()=>N});var t=l(7582),f=l(2382),Z=l(1091),e=l(4893),I=l(2313),d=l(8058),y=l(2561),P=l(2468),E=l(6524),M=l(6501),u=l(9808);function v(r,h){if(1&r){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-icon",23),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.closeModal())}),e.qZA(),e.TgZ(2,"ion-title"),e._uU(3,"Obituary"),e.qZA(),e.BQk()}}function a(r,h){if(1&r&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.message," ")}}function c(r,h){if(1&r&&(e.ynx(0),e.YNc(1,a,2,1,"div",24),e.BQk()),2&r){const o=h.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.ionicForm.get("person_name").hasError(o.type)&&(n.ionicForm.get("person_name").dirty||n.ionicForm.get("person_name").touched))}}function m(r,h){if(1&r&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.message," ")}}function U(r,h){if(1&r&&(e.ynx(0),e.YNc(1,m,2,1,"div",24),e.BQk()),2&r){const o=h.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.ionicForm.get("date_one").hasError(o.type)&&(n.ionicForm.get("date_one").dirty||n.ionicForm.get("date_one").touched))}}function F(r,h){if(1&r){const o=e.EpF();e._UZ(0,"img",26),e.TgZ(1,"ion-icon",27),e.NdJ("click",function(){e.CHM(o);const i=e.MAs(3);return e.KtG(i.click())}),e.qZA(),e.TgZ(2,"input",28,29),e.NdJ("change",function(i){e.CHM(o);const s=e.oxw();return e.KtG(s.loadImageFromDevice(i,"event"))}),e.qZA()}2&r&&e.Q6J("src",h.$implicit,e.LSH)}function B(r,h){if(1&r){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-input",30),e.NdJ("change",function(i){e.CHM(o);const s=e.oxw();return e.KtG(s.loadImageFromDevice(i,"event"))}),e.qZA()(),e.BQk()}}let N=(()=>{class r{constructor(o,n,i,s,p,g,b,C,_,O){this.navParams=n,this._router=i,this.modalController=s,this.dataservice=p,this.chatconnect=g,this.common=b,this.formBuilder=C,this.location=_,this.alertController=O,this.is_modal_open=!1,this.isSubmitted=!1,this.file_uploaddata="",this.Blobimage=[],this.ageControl=null,this.error_messages={person_name:[{type:"required",message:"Name is required."}],date_one:[{type:"required",message:"Date is required."}],date_two:[{type:"required",message:"Date is required."}],desc1:[{type:"required",message:"Description is required."}]},this.imageUrls=[],this.sanitizer=o}submit(){var o,n,i,s,p,g,b,C;return(0,t.mG)(this,void 0,void 0,function*(){if(this.isSubmitted=!0,this.ionicForm.markAllAsTouched(),this.ionicForm.valid){const O=this.dataservice.getUserData(),q=this.navParams.get("community_id");var _=new FormData;null!==O&&_.append("user_token",O),_.append("community_type","1"),_.append("community_id",q);const D=localStorage.getItem("person_img");null!==D&&!this.dataservice.isNullOrUndefined(D)&&_.append("person_img",this.dataservice.convertBase64ToBlob(D)),_.append("type","member"),_.append("person_name",null===(o=this.ionicForm.get("person_name"))||void 0===o?void 0:o.value),_.append("age",null===(n=this.ionicForm.get("age"))||void 0===n?void 0:n.value),_.append("date_one",null===(i=this.ionicForm.get("date_one"))||void 0===i?void 0:i.value),_.append("date_two",null===(s=this.ionicForm.get("date_two"))||void 0===s?void 0:s.value),_.append("date_three",null===(p=this.ionicForm.get("date_three"))||void 0===p?void 0:p.value),_.append("desc1",null===(g=this.ionicForm.get("desc1"))||void 0===g?void 0:g.value),_.append("desc2",null===(b=this.ionicForm.get("desc2"))||void 0===b?void 0:b.value),_.append("valid_till",null===(C=this.ionicForm.get("valid_till"))||void 0===C?void 0:C.value),console.log("formData:",_),this.chatconnect.postFormData(_,"add_obitury").then(T=>{this.common.hide(),1==T.Response.status?(this.common.presentToast("",T.Response.message),localStorage.removeItem("person_img"),this.closeModal()):this.common.presentToast("Oops",T.Response.message)},T=>{this.common.hide(),console.log("Connection failed Messge")})}else(yield this.alertController.create({subHeader:"Please Required details",buttons:["Dismiss"]})).present()})}view(o,n){return(0,t.mG)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:Z.b,cssClass:"my-menubar"});return i.onDidDismiss().then(s=>{null!=s.data&&s.data.cropped_image&&(this.dataservice.convertBase64ToBlob(s.data.cropped_image),"event"==n&&(this.imageUrls=[],this.imageUrls.unshift(s.data.cropped_image),localStorage.setItem("person_img",s.data.cropped_image)))}),yield i.present()})}loadImageFromDevice(o,n){console.log(o);const i=o.target.files[0];console.log(i),this.file_uploaddata=i,console.log(i),(new FormData).append("photo",i,i.name),this.Blobimage.push(i),this.dataservice.blobToBase64(i).then(g=>{this.dataservice.event_base64img=g,this.view(g,n)});const p=new FileReader;p.readAsArrayBuffer(i),p.onload=()=>{let g=new Blob([new Uint8Array(p.result)]),b=URL.createObjectURL(g);"event"==n&&this.imageUrls.unshift(this.sanitizer.bypassSecurityTrustUrl(b))},console.log(this.Blobimage),p.onerror=g=>{}}ngOnInit(){return(0,t.mG)(this,void 0,void 0,function*(){this.is_modal_open=!0,console.log("THis is CommunityID:",this.navParams.get("community_id")),this.ionicForm=this.formBuilder.group({person_name:["",[f.kI.required]],age:[""],date_one:["",[f.kI.required]],date_two:["",[f.kI.required]],date_three:[""],desc1:[""],desc2:[""],valid_till:[""]}),this.ageControl=this.ionicForm.get("age"),this.subscribeToDateChanges()})}subscribeToDateChanges(){const o=this.ionicForm.get("date_one"),n=this.ionicForm.get("date_two");null==o||o.valueChanges.subscribe(()=>this.calculateAge()),null==n||n.valueChanges.subscribe(()=>this.calculateAge())}calculateAge(){var o,n,i;const s=null===(o=this.ionicForm.get("date_one"))||void 0===o?void 0:o.value,p=null===(n=this.ionicForm.get("date_two"))||void 0===n?void 0:n.value;if(s&&p){const g=this.calculateYearDifference(s,p);null===(i=this.ageControl)||void 0===i||i.setValue(g)}}calculateYearDifference(o,n){const i=new Date(o),s=new Date(n),p=Math.abs(s.getTime()-i.getTime()),g=new Date(p);return Math.abs(g.getUTCFullYear()-1970)}closeModal(){return(0,t.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss({dismissed:!0})})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(I.H7),e.Y36(d.X1),e.Y36(y.F0),e.Y36(d.IN),e.Y36(P.D),e.Y36(E.O),e.Y36(M.v),e.Y36(f.qu),e.Y36(u.Ye),e.Y36(d.Br))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-obitury"]],decls:61,vars:7,consts:[[4,"ngIf"],[3,"fullscreen"],[3,"formGroup","ngSubmit"],[1,"container"],["fill","outline"],["position","floating"],[1,"required_sign"],["name","person-outline","slot","start"],["formControlName","person_name","placeholder","Person Name","label-placement","floating",1,"ion-padding-start"],[4,"ngFor","ngForOf"],["name","calendar-outline","slot","start"],["formControlName","date_one","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["formControlName","date_two","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["formControlName","age","placeholder","Person Age","label-placement","floating","type","text",1,"ion-padding-start"],["formControlName","date_three","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["name","list-outline","slot","start"],["formControlName","desc1","placeholder","Details","type","text",1,"ion-padding-start"],["formControlName","desc2","placeholder","Details","type","text",1,"ion-padding-start"],["formControlName","valid_till","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],[1,"images"],["ngFor","",3,"ngForOf"],[1,"ion-no-border"],["expand","block","type","submit","color","secondary","shape","round"],["slot","start","name","arrow-back-outline",3,"click"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"image",3,"src"],["name","add-circle","slot","end",2,"font-size","45px","color","seagreen","position","absolute","right","0",3,"click"],["type","file","id","file-input","accept","image/png, image/jpg, image/jpeg",2,"display","none",3,"change"],["fileInput",""],["type","file","id","file-input","accept","image/png, image/jpeg",1,"custom-file-input",3,"change"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar"),e.YNc(2,v,4,0,"ng-container",0),e.qZA()(),e.TgZ(3,"ion-content",1)(4,"form",2),e.NdJ("ngSubmit",function(){return n.submit()}),e.TgZ(5,"div",3)(6,"ion-item",4)(7,"ion-label",5),e._uU(8,"Name "),e.TgZ(9,"span",6),e._uU(10,"*"),e.qZA()(),e._UZ(11,"ion-icon",7)(12,"ion-input",8),e.qZA(),e.YNc(13,c,2,1,"ng-container",9),e.TgZ(14,"ion-item",4)(15,"ion-label",5),e._uU(16,"Date Of Birth "),e.TgZ(17,"span",6),e._uU(18,"*"),e.qZA()(),e._UZ(19,"ion-icon",10)(20,"ion-input",11),e.qZA(),e.YNc(21,U,2,1,"ng-container",9),e.TgZ(22,"ion-item",4)(23,"ion-label",5),e._uU(24,"Date Of Death"),e.TgZ(25,"span",6),e._uU(26,"*"),e.qZA()(),e._UZ(27,"ion-icon",10)(28,"ion-input",12),e.qZA(),e.TgZ(29,"ion-item",4)(30,"ion-label",5),e._uU(31,"Age"),e.qZA(),e._UZ(32,"ion-icon",10)(33,"ion-input",13),e.qZA(),e.TgZ(34,"ion-item",4)(35,"ion-label",5),e._uU(36,"Funeral Date "),e.qZA(),e._UZ(37,"ion-icon",10)(38,"ion-input",14),e.qZA(),e.TgZ(39,"ion-item",4)(40,"ion-label",5),e._uU(41,"Reason of death"),e.qZA(),e._UZ(42,"ion-icon",15)(43,"ion-textarea",16),e.qZA(),e.TgZ(44,"ion-item",4)(45,"ion-label",5),e._uU(46,"Description"),e.qZA(),e._UZ(47,"ion-icon",15)(48,"ion-textarea",17),e.qZA(),e.TgZ(49,"ion-item",4)(50,"ion-label",5),e._uU(51,"Show till "),e.qZA(),e._UZ(52,"ion-icon",10)(53,"ion-input",18),e.qZA(),e.TgZ(54,"ion-item")(55,"p",19),e.YNc(56,F,4,1,"ng-template",20),e.qZA(),e.YNc(57,B,3,0,"ng-container",0),e.qZA()(),e.TgZ(58,"ion-footer",21)(59,"ion-button",22),e._uU(60,"ADD"),e.qZA()()()()),2&o&&(e.xp6(2),e.Q6J("ngIf",n.is_modal_open),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("formGroup",n.ionicForm),e.xp6(9),e.Q6J("ngForOf",n.error_messages.person_name),e.xp6(8),e.Q6J("ngForOf",n.error_messages.date_one),e.xp6(35),e.Q6J("ngForOf",n.imageUrls),e.xp6(1),e.Q6J("ngIf",!n.imageUrls||0===n.imageUrls.length))},dependencies:[u.sg,u.O5,f._Y,f.JJ,f.JL,d.YG,d.W2,d.fr,d.Gu,d.gu,d.pK,d.Ie,d.Q$,d.Nd,d.g2,d.wd,d.sr,d.j9,f.sg,f.u],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-dark);margin:10px;border-radius:5px;border:1px solid #285500}ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#000}.date[_ngcontent-%COMP%]{text-transform:uppercase}ion-card[_ngcontent-%COMP%]{border:1px solid rgb(124,124,124);padding:0;margin:0}.error-message[_ngcontent-%COMP%]{color:red;padding-left:15px}ion-footer[_ngcontent-%COMP%]{border-top:none}ion-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto;max-width:150px}"]}),r})()},1091:(x,A,l)=>{l.d(A,{b:()=>M});var t=l(4893),f=l(6501),Z=l(2468),e=l(8058),I=l(9808),d=l(3877);const y=["cropper"];function P(u,v){if(1&u){const a=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(a);const m=t.oxw();return t.KtG(m.close())}),t._UZ(1,"ion-icon",8),t.qZA()}}function E(u,v){if(1&u){const a=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(a);const m=t.oxw();return t.KtG(m.cropImage())}),t._UZ(1,"ion-icon",9),t.qZA()}}let M=(()=>{class u{constructor(a,c,m){this.commonservice=a,this.dataservice=c,this.modalController=m,this.myImage=null,this.imageChangedEvent="",this.croppedImage="",this.scale=1,this.transform={}}ngOnInit(){}imageLoaded(){}imageCropped(a){this.croppedImage=a.base64}loadImageFailed(){console.log("Image load failed!")}fileChangeEvent(a){this.imageChangedEvent=a}cropImage(){this.cropper&&this.cropper.crop()&&this.cropper.crop().base64&&(this.croppedImage=this.cropper.crop().base64),this.myImage=null,this.modalController.dismiss({dismissed:!0,cropped_image:this.croppedImage})}close(){this.myImage=null,this.croppedImage=null,this.modalController.dismiss()}discardChanges(){this.myImage=null,this.croppedImage=null}rotate(){var a;const c=((null!==(a=this.transform.rotate)&&void 0!==a?a:0)+90)%360;this.transform=Object.assign(Object.assign({},this.transform),{rotate:c})}zoomOut(){this.scale=Math.max(.1,this.scale-.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}zoomIn(){this.scale=Math.min(3,this.scale+.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}}return u.\u0275fac=function(a){return new(a||u)(t.Y36(f.v),t.Y36(Z.D),t.Y36(e.IN))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-imgcropper"]],viewQuery:function(a,c){if(1&a&&t.Gf(y,5),2&a){let m;t.iGM(m=t.CRH())&&(c.cropper=m.first)}},decls:16,vars:10,consts:[["slot","start"],["color","success",3,"click",4,"ngIf"],["slot","end"],["format","jpeg",3,"imageBase64","imageChangedEvent","maintainAspectRatio","aspectRatio","cropperMaxWidth","cropperMaxHeight","transform","autoCrop","imageCropped","loadImageFailed","imageLoaded"],["cropper",""],[2,"display","flex","justify-content","space-around"],[3,"click"],["color","success",3,"click"],["color","danger","slot","icon-only","name","close"],["color","success","slot","icon-only","name","checkmark"]],template:function(a,c){1&a&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"Crop "),t.qZA(),t.TgZ(4,"ion-buttons",0),t.YNc(5,P,2,0,"ion-button",1),t.qZA(),t.TgZ(6,"ion-buttons",2),t.YNc(7,E,2,0,"ion-button",1),t.qZA()()(),t.TgZ(8,"ion-content")(9,"image-cropper",3,4),t.NdJ("imageCropped",function(U){return c.imageCropped(U)})("loadImageFailed",function(){return c.loadImageFailed()})("imageLoaded",function(){return c.imageLoaded()}),t.qZA(),t.TgZ(11,"div",5)(12,"ion-button",6),t.NdJ("click",function(){return c.zoomOut()}),t._uU(13,"Zoom -"),t.qZA(),t.TgZ(14,"ion-button",6),t.NdJ("click",function(){return c.zoomIn()}),t._uU(15,"Zoom +"),t.qZA()()()),2&a&&(t.xp6(5),t.Q6J("ngIf",c.dataservice.event_base64img),t.xp6(2),t.Q6J("ngIf",c.dataservice.event_base64img),t.xp6(2),t.Q6J("imageBase64",c.dataservice.event_base64img)("imageChangedEvent",c.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",16/9)("cropperMaxWidth",3e3)("cropperMaxHeight",3e3)("transform",c.transform)("autoCrop",!1))},dependencies:[I.O5,d.ap,e.YG,e.Sm,e.W2,e.Gu,e.gu,e.wd,e.sr]}),u})()}}]);