"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1853],{1853:(N,I,r)=>{r.d(I,{k:()=>B});var t=r(7582),u=r(2382),Z=r(1091),e=r(4893),T=r(2313),g=r(8058),E=r(2561),A=r(2468),P=r(6524),M=r(6501),p=r(9808);function b(c,v){if(1&c){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-icon",23),e.NdJ("click",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.closeModal())}),e.qZA(),e.TgZ(2,"ion-title"),e._uU(3,"Obituary"),e.qZA(),e.BQk()}}function i(c,v){if(1&c&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&c){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.message," ")}}function s(c,v){if(1&c&&(e.ynx(0),e.YNc(1,i,2,1,"div",24),e.BQk()),2&c){const o=v.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.ionicForm.get("person_name").hasError(o.type)&&(n.ionicForm.get("person_name").dirty||n.ionicForm.get("person_name").touched))}}function l(c,v){if(1&c&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&c){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.message," ")}}function C(c,v){if(1&c&&(e.ynx(0),e.YNc(1,l,2,1,"div",24),e.BQk()),2&c){const o=v.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.ionicForm.get("date_one").hasError(o.type)&&(n.ionicForm.get("date_one").dirty||n.ionicForm.get("date_one").touched))}}function O(c,v){if(1&c){const o=e.EpF();e._UZ(0,"img",26),e.TgZ(1,"ion-icon",27),e.NdJ("click",function(){e.CHM(o);const a=e.MAs(3);return e.KtG(a.click())}),e.qZA(),e.TgZ(2,"input",28,29),e.NdJ("change",function(a){e.CHM(o);const d=e.oxw();return e.KtG(d.loadImageFromDevice(a,"event"))}),e.qZA()}2&c&&e.Q6J("src",v.$implicit,e.LSH)}function m(c,v){if(1&c){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-input",30),e.NdJ("change",function(a){e.CHM(o);const d=e.oxw();return e.KtG(d.loadImageFromDevice(a,"event"))}),e.qZA()(),e.BQk()}}let B=(()=>{class c{constructor(o,n,a,d,h,f,y,U,_,D){this.navParams=n,this._router=a,this.modalController=d,this.dataservice=h,this.chatconnect=f,this.common=y,this.formBuilder=U,this.location=_,this.alertController=D,this.is_modal_open=!1,this.isSubmitted=!1,this.file_uploaddata="",this.Blobimage=[],this.ageControl=null,this.error_messages={person_name:[{type:"required",message:"Name is required."}],date_one:[{type:"required",message:"Date is required."}],date_two:[{type:"required",message:"Date is required."}],desc1:[{type:"required",message:"Description is required."}]},this.imageUrls=[],this.sanitizer=o}submit(){var o,n,a,d,h,f,y,U;return(0,t.mG)(this,void 0,void 0,function*(){if(this.isSubmitted=!0,this.ionicForm.markAllAsTouched(),this.ionicForm.valid){const D=this.dataservice.getUserData(),R=this.navParams.get("community_id");var _=new FormData;null!==D&&_.append("user_token",D),_.append("community_type","1"),_.append("community_id",R);const F=localStorage.getItem("person_img");null!==F&&!this.dataservice.isNullOrUndefined(F)&&_.append("person_img",this.dataservice.convertBase64ToBlob(F)),_.append("type","member"),_.append("person_name",null===(o=this.ionicForm.get("person_name"))||void 0===o?void 0:o.value),_.append("age",null===(n=this.ionicForm.get("age"))||void 0===n?void 0:n.value),_.append("date_one",null===(a=this.ionicForm.get("date_one"))||void 0===a?void 0:a.value),_.append("date_two",null===(d=this.ionicForm.get("date_two"))||void 0===d?void 0:d.value),_.append("date_three",null===(h=this.ionicForm.get("date_three"))||void 0===h?void 0:h.value),_.append("desc1",null===(f=this.ionicForm.get("desc1"))||void 0===f?void 0:f.value),_.append("desc2",null===(y=this.ionicForm.get("desc2"))||void 0===y?void 0:y.value),_.append("valid_till",null===(U=this.ionicForm.get("valid_till"))||void 0===U?void 0:U.value),console.log("formData:",_),this.chatconnect.postFormData(_,"add_obitury").then(x=>{this.common.hide(),1==x.Response.status?(this.common.presentToast("",x.Response.message),localStorage.removeItem("person_img"),this.closeModal()):this.common.presentToast("Oops",x.Response.message)},x=>{this.common.hide(),console.log("Connection failed Messge")})}else(yield this.alertController.create({subHeader:"Please Required details",buttons:["Dismiss"]})).present()})}view(o,n){return(0,t.mG)(this,void 0,void 0,function*(){const a=yield this.modalController.create({component:Z.b,cssClass:"my-menubar"});return a.onDidDismiss().then(d=>{null!=d.data&&d.data.cropped_image&&(this.dataservice.convertBase64ToBlob(d.data.cropped_image),"event"==n&&(this.imageUrls=[],this.imageUrls.unshift(d.data.cropped_image),localStorage.setItem("person_img",d.data.cropped_image)))}),yield a.present()})}loadImageFromDevice(o,n){console.log(o);const a=o.target.files[0];console.log(a),this.file_uploaddata=a,console.log(a),(new FormData).append("photo",a,a.name),this.Blobimage.push(a),this.dataservice.blobToBase64(a).then(f=>{this.dataservice.event_base64img=f,this.view(f,n)});const h=new FileReader;h.readAsArrayBuffer(a),h.onload=()=>{let f=new Blob([new Uint8Array(h.result)]),y=URL.createObjectURL(f);"event"==n&&this.imageUrls.unshift(this.sanitizer.bypassSecurityTrustUrl(y))},console.log(this.Blobimage),h.onerror=f=>{}}ngOnInit(){return(0,t.mG)(this,void 0,void 0,function*(){this.is_modal_open=!0,console.log("THis is CommunityID:",this.navParams.get("community_id")),this.ionicForm=this.formBuilder.group({person_name:["",[u.kI.required]],age:[""],date_one:["",[u.kI.required]],date_two:["",[u.kI.required]],date_three:[""],desc1:[""],desc2:[""],valid_till:[""]}),this.ageControl=this.ionicForm.get("age"),this.subscribeToDateChanges()})}subscribeToDateChanges(){const o=this.ionicForm.get("date_one"),n=this.ionicForm.get("date_two");null==o||o.valueChanges.subscribe(()=>this.calculateAge()),null==n||n.valueChanges.subscribe(()=>this.calculateAge())}calculateAge(){var o,n,a;const d=null===(o=this.ionicForm.get("date_one"))||void 0===o?void 0:o.value,h=null===(n=this.ionicForm.get("date_two"))||void 0===n?void 0:n.value;if(d&&h){const f=this.calculateYearDifference(d,h);null===(a=this.ageControl)||void 0===a||a.setValue(f)}}calculateYearDifference(o,n){const a=new Date(o),d=new Date(n),h=Math.abs(d.getTime()-a.getTime()),f=new Date(h);return Math.abs(f.getUTCFullYear()-1970)}closeModal(){return(0,t.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss({dismissed:!0})})}}return c.\u0275fac=function(o){return new(o||c)(e.Y36(T.H7),e.Y36(g.X1),e.Y36(E.F0),e.Y36(g.IN),e.Y36(A.D),e.Y36(P.O),e.Y36(M.v),e.Y36(u.qu),e.Y36(p.Ye),e.Y36(g.Br))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-add-obitury"]],decls:61,vars:7,consts:[[4,"ngIf"],[3,"fullscreen"],[3,"formGroup","ngSubmit"],[1,"container"],["fill","outline"],["position","floating"],[1,"required_sign"],["name","person-outline","slot","start"],["formControlName","person_name","placeholder","Person Name","label-placement","floating",1,"ion-padding-start"],[4,"ngFor","ngForOf"],["name","calendar-outline","slot","start"],["formControlName","date_one","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["formControlName","date_two","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["formControlName","age","placeholder","Person Age","label-placement","floating","type","text",1,"ion-padding-start"],["formControlName","date_three","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],["name","list-outline","slot","start"],["formControlName","desc1","placeholder","Details","type","text",1,"ion-padding-start"],["formControlName","desc2","placeholder","Details","type","text",1,"ion-padding-start"],["formControlName","valid_till","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start"],[1,"images"],["ngFor","",3,"ngForOf"],[1,"ion-no-border"],["expand","block","type","submit","color","secondary","shape","round"],["slot","start","name","arrow-back-outline",3,"click"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"image",3,"src"],["name","add-circle","slot","end",2,"font-size","45px","color","seagreen","position","absolute","right","0",3,"click"],["type","file","id","file-input","accept","image/png, image/jpg, image/jpeg",2,"display","none",3,"change"],["fileInput",""],["type","file","id","file-input","accept","image/png, image/jpeg",1,"custom-file-input",3,"change"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar"),e.YNc(2,b,4,0,"ng-container",0),e.qZA()(),e.TgZ(3,"ion-content",1)(4,"form",2),e.NdJ("ngSubmit",function(){return n.submit()}),e.TgZ(5,"div",3)(6,"ion-item",4)(7,"ion-label",5),e._uU(8,"Name "),e.TgZ(9,"span",6),e._uU(10,"*"),e.qZA()(),e._UZ(11,"ion-icon",7)(12,"ion-input",8),e.qZA(),e.YNc(13,s,2,1,"ng-container",9),e.TgZ(14,"ion-item",4)(15,"ion-label",5),e._uU(16,"Date Of Birth "),e.TgZ(17,"span",6),e._uU(18,"*"),e.qZA()(),e._UZ(19,"ion-icon",10)(20,"ion-input",11),e.qZA(),e.YNc(21,C,2,1,"ng-container",9),e.TgZ(22,"ion-item",4)(23,"ion-label",5),e._uU(24,"Date Of Death"),e.TgZ(25,"span",6),e._uU(26,"*"),e.qZA()(),e._UZ(27,"ion-icon",10)(28,"ion-input",12),e.qZA(),e.TgZ(29,"ion-item",4)(30,"ion-label",5),e._uU(31,"Age"),e.qZA(),e._UZ(32,"ion-icon",10)(33,"ion-input",13),e.qZA(),e.TgZ(34,"ion-item",4)(35,"ion-label",5),e._uU(36,"Funeral Date "),e.qZA(),e._UZ(37,"ion-icon",10)(38,"ion-input",14),e.qZA(),e.TgZ(39,"ion-item",4)(40,"ion-label",5),e._uU(41,"Reason of death"),e.qZA(),e._UZ(42,"ion-icon",15)(43,"ion-textarea",16),e.qZA(),e.TgZ(44,"ion-item",4)(45,"ion-label",5),e._uU(46,"Description"),e.qZA(),e._UZ(47,"ion-icon",15)(48,"ion-textarea",17),e.qZA(),e.TgZ(49,"ion-item",4)(50,"ion-label",5),e._uU(51,"Show till "),e.qZA(),e._UZ(52,"ion-icon",10)(53,"ion-input",18),e.qZA(),e.TgZ(54,"ion-item")(55,"p",19),e.YNc(56,O,4,1,"ng-template",20),e.qZA(),e.YNc(57,m,3,0,"ng-container",0),e.qZA()(),e.TgZ(58,"ion-footer",21)(59,"ion-button",22),e._uU(60,"ADD"),e.qZA()()()()),2&o&&(e.xp6(2),e.Q6J("ngIf",n.is_modal_open),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("formGroup",n.ionicForm),e.xp6(9),e.Q6J("ngForOf",n.error_messages.person_name),e.xp6(8),e.Q6J("ngForOf",n.error_messages.date_one),e.xp6(35),e.Q6J("ngForOf",n.imageUrls),e.xp6(1),e.Q6J("ngIf",!n.imageUrls||0===n.imageUrls.length))},dependencies:[p.sg,p.O5,u._Y,u.JJ,u.JL,g.YG,g.W2,g.fr,g.Gu,g.gu,g.pK,g.Ie,g.Q$,g.Nd,g.g2,g.wd,g.sr,g.j9,u.sg,u.u],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-dark);margin:10px;border-radius:5px;border:1px solid #285500}ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#000}.date[_ngcontent-%COMP%]{text-transform:uppercase}ion-card[_ngcontent-%COMP%]{border:1px solid rgb(124,124,124);padding:0;margin:0}.error-message[_ngcontent-%COMP%]{color:red;padding-left:15px}ion-footer[_ngcontent-%COMP%]{border-top:none}ion-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto;max-width:150px}"]}),c})()},1091:(N,I,r)=>{r.d(I,{b:()=>M});var t=r(4893),u=r(6501),Z=r(2468),e=r(8058),T=r(9808),g=r(3877);const E=["cropper"];function A(p,b){if(1&p){const i=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(i);const l=t.oxw();return t.KtG(l.close())}),t._UZ(1,"ion-icon",8),t.qZA()}}function P(p,b){if(1&p){const i=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(i);const l=t.oxw();return t.KtG(l.cropImage())}),t._UZ(1,"ion-icon",9),t.qZA()}}let M=(()=>{class p{constructor(i,s,l){this.commonservice=i,this.dataservice=s,this.modalController=l,this.myImage=null,this.imageChangedEvent="",this.croppedImage="",this.scale=1,this.transform={}}ngOnInit(){}imageLoaded(){}imageCropped(i){this.croppedImage=i.base64}loadImageFailed(){console.log("Image load failed!")}fileChangeEvent(i){this.imageChangedEvent=i}cropImage(){this.cropper&&this.cropper.crop()&&this.cropper.crop().base64&&(this.croppedImage=this.cropper.crop().base64),this.myImage=null,this.modalController.dismiss({dismissed:!0,cropped_image:this.croppedImage})}close(){this.myImage=null,this.croppedImage=null,this.modalController.dismiss()}discardChanges(){this.myImage=null,this.croppedImage=null}rotate(){var i;const s=((null!==(i=this.transform.rotate)&&void 0!==i?i:0)+90)%360;this.transform=Object.assign(Object.assign({},this.transform),{rotate:s})}zoomOut(){this.scale=Math.max(.1,this.scale-.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}zoomIn(){this.scale=Math.min(3,this.scale+.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}}return p.\u0275fac=function(i){return new(i||p)(t.Y36(u.v),t.Y36(Z.D),t.Y36(e.IN))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-imgcropper"]],viewQuery:function(i,s){if(1&i&&t.Gf(E,5),2&i){let l;t.iGM(l=t.CRH())&&(s.cropper=l.first)}},decls:16,vars:10,consts:[["slot","start"],["color","success",3,"click",4,"ngIf"],["slot","end"],["format","jpeg",3,"imageBase64","imageChangedEvent","maintainAspectRatio","aspectRatio","cropperMaxWidth","cropperMaxHeight","transform","autoCrop","imageCropped","loadImageFailed","imageLoaded"],["cropper",""],[2,"display","flex","justify-content","space-around"],[3,"click"],["color","success",3,"click"],["color","danger","slot","icon-only","name","close"],["color","success","slot","icon-only","name","checkmark"]],template:function(i,s){1&i&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"Crop "),t.qZA(),t.TgZ(4,"ion-buttons",0),t.YNc(5,A,2,0,"ion-button",1),t.qZA(),t.TgZ(6,"ion-buttons",2),t.YNc(7,P,2,0,"ion-button",1),t.qZA()()(),t.TgZ(8,"ion-content")(9,"image-cropper",3,4),t.NdJ("imageCropped",function(C){return s.imageCropped(C)})("loadImageFailed",function(){return s.loadImageFailed()})("imageLoaded",function(){return s.imageLoaded()}),t.qZA(),t.TgZ(11,"div",5)(12,"ion-button",6),t.NdJ("click",function(){return s.zoomOut()}),t._uU(13,"Zoom -"),t.qZA(),t.TgZ(14,"ion-button",6),t.NdJ("click",function(){return s.zoomIn()}),t._uU(15,"Zoom +"),t.qZA()()()),2&i&&(t.xp6(5),t.Q6J("ngIf",s.dataservice.event_base64img),t.xp6(2),t.Q6J("ngIf",s.dataservice.event_base64img),t.xp6(2),t.Q6J("imageBase64",s.dataservice.event_base64img)("imageChangedEvent",s.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",16/9)("cropperMaxWidth",3e3)("cropperMaxHeight",3e3)("transform",s.transform)("autoCrop",!1))},dependencies:[T.O5,g.ap,e.YG,e.Sm,e.W2,e.Gu,e.gu,e.wd,e.sr]}),p})()},6524:(N,I,r)=>{r.d(I,{O:()=>M});var t=r(7582),u=r(520);const e=(0,r(7423).fo)("Network",{web:()=>r.e(4203).then(r.bind(r,4203)).then(p=>new p.NetworkWeb)});var T=r(4893),g=r(2468),E=r(6501);let A="https://api.soeasyapp.com/",M=(()=>{class p{constructor(i,s,l){this.http=i,this.dataservice=s,this.common=l,this.checkInternetConnection()}initiatePayment(i,s){const l={headers:(new u.WM).set("Content-Type","application/json").set("Authorization","PAY46ZGYME1AE6LUR1AVI1701862757.YFGJ11SECKEY")};return new Promise((C,O)=>{this.http.post("https://admin.payomatix.com/payment/merchant/"+s,JSON.stringify(i),l).subscribe(m=>{C(m)},m=>{O(m),"HttpErrorResponse"==m.name&&("Unknown Error"==m.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==m.statusText?"Something Went Wrong...":m.statusText)),console.log("In Chatconnect provider : Error",m)})})}postData(i,s){const l={headers:(new u.WM).set("Content-Type","application/json")};return new Promise((C,O)=>{this.http.post(A+s,JSON.stringify(i),l).subscribe(m=>{C(m)},m=>{O(m),"HttpErrorResponse"==m.name&&("Unknown Error"==m.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==m.statusText?"Something Went Wrong...":m.statusText)),console.log("In Chatconnect provider : Error",m)})})}checkInternetConnection(){return(0,t.mG)(this,void 0,void 0,function*(){(yield e.getStatus()).connected?console.log("Internet is connected"):(console.log("No internet connection"),this.common.presentToast("","Check your internet connection"))})}postFormData(i,s){return new Promise((l,C)=>{const O=(new u.WM).set("Accept","application/json");this.http.post(A+s,i,{headers:O}).subscribe(m=>{l(m)},m=>{C(m)})})}}return p.\u0275fac=function(i){return new(i||p)(T.LFG(u.eN),T.LFG(g.D),T.LFG(E.v))},p.\u0275prov=T.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);