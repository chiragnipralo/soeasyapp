"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3686],{3686:(N,Z,r)=>{r.r(Z),r.d(Z,{AddObituaryPageModule:()=>Y});var t=r(9808),g=r(2382),l=r(8058),b=r(2561),y=r(7582),I=r(1091),e=r(4893),x=r(2313),F=r(2468),P=r(6524),u=r(6501);function C(i,h){if(1&i&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&i){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.message," ")}}function a(i,h){if(1&i&&(e.ynx(0),e.YNc(1,C,2,1,"div",25),e.BQk()),2&i){const n=h.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.ionicForm.get("person_name").hasError(n.type)&&(o.ionicForm.get("person_name").dirty||o.ionicForm.get("person_name").touched))}}function c(i,h){if(1&i&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&i){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.message," ")}}function d(i,h){if(1&i&&(e.ynx(0),e.YNc(1,c,2,1,"div",25),e.BQk()),2&i){const n=h.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.ionicForm.get("date_one").hasError(n.type)&&(o.ionicForm.get("date_one").dirty||o.ionicForm.get("date_one").touched))}}function A(i,h){if(1&i&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&i){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.message," ")}}function T(i,h){if(1&i&&(e.ynx(0),e.YNc(1,A,2,1,"div",25),e.BQk()),2&i){const n=h.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.ionicForm.get("date_two").hasError(n.type)&&(o.ionicForm.get("date_two").dirty||o.ionicForm.get("date_two").touched))}}function m(i,h){if(1&i){const n=e.EpF();e._UZ(0,"img",27),e.TgZ(1,"ion-icon",28),e.NdJ("click",function(){e.CHM(n);const s=e.MAs(3);return e.KtG(s.click())}),e.qZA(),e.TgZ(2,"input",29,30),e.NdJ("change",function(s){e.CHM(n);const p=e.oxw();return e.KtG(p.loadImageFromDevice(s,"event"))}),e.qZA()}2&i&&e.Q6J("src",h.$implicit,e.LSH)}function w(i,h){if(1&i){const n=e.EpF();e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-input",31),e.NdJ("change",function(s){e.CHM(n);const p=e.oxw();return e.KtG(p.loadImageFromDevice(s,"event"))}),e.qZA()(),e.BQk()}}const J=[{path:"",component:(()=>{class i{constructor(n,o,s,p,f,v,O,U,_){this._router=o,this.modalController=s,this.dataservice=p,this.chatconnect=f,this.common=v,this.formBuilder=O,this.location=U,this.alertController=_,this.isSubmitted=!1,this.file_uploaddata="",this.Blobimage=[],this.ageControl=null,this.maxDate=(new Date).toISOString().split("T")[0],this.minFuneralDate=(new Date).toISOString().split("T")[0],this.error_messages={person_name:[{type:"required",message:"Name is required."}],date_one:[{type:"required",message:"Date of birth is required."},{type:"max",message:"Date cannot be in the future."}],date_two:[{type:"required",message:"Date of death is required."},{type:"max",message:"Date cannot be in the future."}],desc1:[{type:"required",message:"Description is required."}]},this.imageUrls=[],this.sanitizer=n}submit(){var n,o,s,p,f,v,O,U;return(0,y.mG)(this,void 0,void 0,function*(){if(this.isSubmitted=!0,this.ionicForm.markAllAsTouched(),this.ionicForm.valid){const D=this.dataservice.getUserData(),B=this.dataservice.GetAccountuser();var _=new FormData;null!==D&&_.append("user_token",D),_.append("community_type","1"),_.append("community_id",B);const E=localStorage.getItem("person_img");null!==E&&!this.dataservice.isNullOrUndefined(E)&&_.append("person_img",this.dataservice.convertBase64ToBlob(E)),_.append("type","admin"),_.append("person_name",null===(n=this.ionicForm.get("person_name"))||void 0===n?void 0:n.value),_.append("age",null===(o=this.ionicForm.get("age"))||void 0===o?void 0:o.value),_.append("date_one",null===(s=this.ionicForm.get("date_one"))||void 0===s?void 0:s.value),_.append("date_two",null===(p=this.ionicForm.get("date_two"))||void 0===p?void 0:p.value),_.append("date_three",null===(f=this.ionicForm.get("date_three"))||void 0===f?void 0:f.value),_.append("desc1",null===(v=this.ionicForm.get("desc1"))||void 0===v?void 0:v.value),_.append("desc2",null===(O=this.ionicForm.get("desc2"))||void 0===O?void 0:O.value),_.append("valid_till",null===(U=this.ionicForm.get("valid_till"))||void 0===U?void 0:U.value),console.log("formData:",_),this.chatconnect.postFormData(_,"add_obitury").then(M=>{this.common.hide(),1==M.Response.status?(this.common.presentToast("",M.Response.message),localStorage.removeItem("person_img"),this.location.back()):this.common.presentToast("Oops",M.Response.message)},M=>{this.common.hide(),console.log("Connection failed Message")})}else(yield this.alertController.create({subHeader:"Please provide required details",buttons:["Dismiss"]})).present()})}view(n,o){return(0,y.mG)(this,void 0,void 0,function*(){const s=yield this.modalController.create({component:I.b,cssClass:"my-menubar"});return s.onDidDismiss().then(p=>{null!=p.data&&p.data.cropped_image&&(this.dataservice.convertBase64ToBlob(p.data.cropped_image),"event"==o&&(this.imageUrls=[],this.imageUrls.unshift(p.data.cropped_image),localStorage.setItem("person_img",p.data.cropped_image)))}),yield s.present()})}loadImageFromDevice(n,o){console.log(n);const s=n.target.files[0];console.log(s),this.file_uploaddata=s,console.log(s),(new FormData).append("photo",s,s.name),this.Blobimage.push(s),this.dataservice.blobToBase64(s).then(v=>{this.dataservice.event_base64img=v,this.view(v,o)});const f=new FileReader;f.readAsArrayBuffer(s),f.onload=()=>{let v=new Blob([new Uint8Array(f.result)]),O=URL.createObjectURL(v);"event"==o&&this.imageUrls.unshift(this.sanitizer.bypassSecurityTrustUrl(O))},console.log(this.Blobimage),f.onerror=v=>{}}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){this.ionicForm=this.formBuilder.group({person_name:["",[g.kI.required]],age:[""],date_one:["",[g.kI.required,g.kI.max(this.maxDate)]],date_two:["",[g.kI.required]],date_three:["",[g.kI.min(this.minFuneralDate)]],desc1:[""],desc2:[""],valid_till:[""]}),this.ageControl=this.ionicForm.get("age"),this.subscribeToDateChanges()})}subscribeToDateChanges(){const n=this.ionicForm.get("date_one"),o=this.ionicForm.get("date_two");null==n||n.valueChanges.subscribe(()=>this.calculateAge()),null==o||o.valueChanges.subscribe(()=>this.calculateAge())}calculateAge(){var n,o,s;const p=null===(n=this.ionicForm.get("date_one"))||void 0===n?void 0:n.value,f=null===(o=this.ionicForm.get("date_two"))||void 0===o?void 0:o.value;if(p&&f){const v=this.calculateYearDifference(p,f);null===(s=this.ageControl)||void 0===s||s.setValue(v)}}calculateYearDifference(n,o){const s=new Date(n),p=new Date(o),f=Math.abs(p.getTime()-s.getTime()),v=new Date(f);return Math.abs(v.getUTCFullYear()-1970)}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(x.H7),e.Y36(b.F0),e.Y36(l.IN),e.Y36(F.D),e.Y36(P.O),e.Y36(u.v),e.Y36(g.qu),e.Y36(t.Ye),e.Y36(l.Br))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-obituary"]],decls:66,vars:10,consts:[[1,"top"],["slot","start"],["text","","icon","arrow-back-outline"],[3,"formGroup","ngSubmit"],[1,"container"],["fill","outline"],["position","floating"],[1,"required_sign"],["name","person-outline","slot","start"],["formControlName","person_name","placeholder","Person Name","label-placement","floating",1,"ion-padding-start"],[4,"ngFor","ngForOf"],["name","calendar-outline","slot","start"],["formControlName","date_one","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start",3,"max"],["formControlName","date_two","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start",3,"max"],["formControlName","age","placeholder","Person Age","label-placement","floating","type","text","readonly","",1,"ion-padding-start"],["formControlName","date_three","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start",3,"min"],["name","list-outline","slot","start"],["formControlName","desc1","placeholder","Message","type","text",1,"ion-padding-start"],["formControlName","desc2","placeholder","Details","type","text",1,"ion-padding-start"],["formControlName","valid_till","placeholder","Person Expired","label-placement","floating","type","date",1,"ion-padding-start",3,"max"],[1,"images"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[1,"ion-no-border"],["expand","block","type","submit","color","secondary","shape","round"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"image",3,"src"],["name","add-circle","slot","end",2,"font-size","45px","color","seagreen","position","absolute","right","0",3,"click"],["type","file","id","file-input","accept","image/png, image/jpg, image/jpeg",2,"display","none",3,"change"],["fileInput",""],["type","file","id","file-input","accept","image/png, image/jpeg",1,"custom-file-input",3,"change"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"div",0)(3,"ion-buttons",1),e._UZ(4,"ion-back-button",2),e.qZA(),e.TgZ(5,"ion-title"),e._uU(6,"Add Obituary"),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"form",3),e.NdJ("ngSubmit",function(){return o.submit()}),e.TgZ(9,"div",4)(10,"ion-item",5)(11,"ion-label",6),e._uU(12,"Name "),e.TgZ(13,"span",7),e._uU(14,"*"),e.qZA()(),e._UZ(15,"ion-icon",8)(16,"ion-input",9),e.qZA(),e.YNc(17,a,2,1,"ng-container",10),e.TgZ(18,"ion-item",5)(19,"ion-label",6),e._uU(20,"Date of Birth "),e.TgZ(21,"span",7),e._uU(22,"*"),e.qZA()(),e._UZ(23,"ion-icon",11)(24,"ion-input",12),e.qZA(),e.YNc(25,d,2,1,"ng-container",10),e.TgZ(26,"ion-item",5)(27,"ion-label",6),e._uU(28,"Date of Death "),e.TgZ(29,"span",7),e._uU(30,"*"),e.qZA()(),e._UZ(31,"ion-icon",11)(32,"ion-input",13),e.qZA(),e.YNc(33,T,2,1,"ng-container",10),e.TgZ(34,"ion-item",5)(35,"ion-label",6),e._uU(36,"Age"),e.qZA(),e._UZ(37,"ion-icon",11)(38,"ion-input",14),e.qZA(),e.TgZ(39,"ion-item",5)(40,"ion-label",6),e._uU(41,"Funeral Date "),e.qZA(),e._UZ(42,"ion-icon",11)(43,"ion-input",15),e.qZA(),e.TgZ(44,"ion-item",5)(45,"ion-label",6),e._uU(46,"Reason of death"),e.qZA(),e._UZ(47,"ion-icon",16)(48,"ion-textarea",17),e.qZA(),e.TgZ(49,"ion-item",5)(50,"ion-label",6),e._uU(51,"Description 2"),e.qZA(),e._UZ(52,"ion-icon",16)(53,"ion-textarea",18),e.qZA(),e.TgZ(54,"ion-item",5)(55,"ion-label",6),e._uU(56,"Show till "),e.qZA(),e._UZ(57,"ion-icon",11)(58,"ion-input",19),e.qZA(),e.TgZ(59,"ion-item")(60,"p",20),e.YNc(61,m,4,1,"ng-template",21),e.qZA(),e.YNc(62,w,3,0,"ng-container",22),e.qZA()(),e.TgZ(63,"ion-footer",23)(64,"ion-button",24),e._uU(65,"ADD"),e.qZA()()()()),2&n&&(e.xp6(8),e.Q6J("formGroup",o.ionicForm),e.xp6(9),e.Q6J("ngForOf",o.error_messages.person_name),e.xp6(7),e.Q6J("max",o.maxDate),e.xp6(1),e.Q6J("ngForOf",o.error_messages.date_one),e.xp6(7),e.Q6J("max",o.maxDate),e.xp6(1),e.Q6J("ngForOf",o.error_messages.date_two),e.xp6(10),e.Q6J("min",o.minFuneralDate),e.xp6(15),e.Q6J("max",o.maxDate),e.xp6(3),e.Q6J("ngForOf",o.imageUrls),e.xp6(1),e.Q6J("ngIf",!o.imageUrls||0===o.imageUrls.length))},dependencies:[t.sg,t.O5,g._Y,g.JJ,g.JL,l.oU,l.YG,l.Sm,l.W2,l.fr,l.Gu,l.gu,l.pK,l.Ie,l.Q$,l.Nd,l.g2,l.wd,l.sr,l.j9,l.cs,g.sg,g.u],styles:[".top[_ngcontent-%COMP%]{display:flex;align-items:center}.top[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center;position:absolute;inset:0}ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-dark);margin:10px;border-radius:5px;border:1px solid #285500}ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#000}.date[_ngcontent-%COMP%]{text-transform:uppercase}ion-card[_ngcontent-%COMP%]{border:1px solid rgb(124,124,124);padding:0;margin:0}.error-message[_ngcontent-%COMP%]{color:red;padding-left:15px}ion-footer[_ngcontent-%COMP%]{border-top:none;bottom:5px}ion-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto;max-width:150px}"]}),i})()}];let S=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[b.Bz.forChild(J),b.Bz]}),i})(),Y=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[t.ez,g.u5,l.Pc,g.UX,S]}),i})()},1091:(N,Z,r)=>{r.d(Z,{b:()=>P});var t=r(4893),g=r(6501),l=r(2468),b=r(8058),y=r(9808),I=r(3877);const e=["cropper"];function x(u,C){if(1&u){const a=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.close())}),t._UZ(1,"ion-icon",8),t.qZA()}}function F(u,C){if(1&u){const a=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.cropImage())}),t._UZ(1,"ion-icon",9),t.qZA()}}let P=(()=>{class u{constructor(a,c,d){this.commonservice=a,this.dataservice=c,this.modalController=d,this.myImage=null,this.imageChangedEvent="",this.croppedImage="",this.scale=1,this.transform={}}ngOnInit(){}imageLoaded(){}imageCropped(a){this.croppedImage=a.base64}loadImageFailed(){console.log("Image load failed!")}fileChangeEvent(a){this.imageChangedEvent=a}cropImage(){this.cropper&&this.cropper.crop()&&this.cropper.crop().base64&&(this.croppedImage=this.cropper.crop().base64),this.myImage=null,this.modalController.dismiss({dismissed:!0,cropped_image:this.croppedImage})}close(){this.myImage=null,this.croppedImage=null,this.modalController.dismiss()}discardChanges(){this.myImage=null,this.croppedImage=null}rotate(){var a;const c=((null!==(a=this.transform.rotate)&&void 0!==a?a:0)+90)%360;this.transform=Object.assign(Object.assign({},this.transform),{rotate:c})}zoomOut(){this.scale=Math.max(.1,this.scale-.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}zoomIn(){this.scale=Math.min(3,this.scale+.1),this.transform=Object.assign(Object.assign({},this.transform),{scale:this.scale})}}return u.\u0275fac=function(a){return new(a||u)(t.Y36(g.v),t.Y36(l.D),t.Y36(b.IN))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-imgcropper"]],viewQuery:function(a,c){if(1&a&&t.Gf(e,5),2&a){let d;t.iGM(d=t.CRH())&&(c.cropper=d.first)}},decls:16,vars:10,consts:[["slot","start"],["color","success",3,"click",4,"ngIf"],["slot","end"],["format","jpeg",3,"imageBase64","imageChangedEvent","maintainAspectRatio","aspectRatio","cropperMaxWidth","cropperMaxHeight","transform","autoCrop","imageCropped","loadImageFailed","imageLoaded"],["cropper",""],[2,"display","flex","justify-content","space-around"],[3,"click"],["color","success",3,"click"],["color","danger","slot","icon-only","name","close"],["color","success","slot","icon-only","name","checkmark"]],template:function(a,c){1&a&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"Crop "),t.qZA(),t.TgZ(4,"ion-buttons",0),t.YNc(5,x,2,0,"ion-button",1),t.qZA(),t.TgZ(6,"ion-buttons",2),t.YNc(7,F,2,0,"ion-button",1),t.qZA()()(),t.TgZ(8,"ion-content")(9,"image-cropper",3,4),t.NdJ("imageCropped",function(A){return c.imageCropped(A)})("loadImageFailed",function(){return c.loadImageFailed()})("imageLoaded",function(){return c.imageLoaded()}),t.qZA(),t.TgZ(11,"div",5)(12,"ion-button",6),t.NdJ("click",function(){return c.zoomOut()}),t._uU(13,"Zoom -"),t.qZA(),t.TgZ(14,"ion-button",6),t.NdJ("click",function(){return c.zoomIn()}),t._uU(15,"Zoom +"),t.qZA()()()),2&a&&(t.xp6(5),t.Q6J("ngIf",c.dataservice.event_base64img),t.xp6(2),t.Q6J("ngIf",c.dataservice.event_base64img),t.xp6(2),t.Q6J("imageBase64",c.dataservice.event_base64img)("imageChangedEvent",c.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",16/9)("cropperMaxWidth",3e3)("cropperMaxHeight",3e3)("transform",c.transform)("autoCrop",!1))},dependencies:[y.O5,I.ap,b.YG,b.Sm,b.W2,b.Gu,b.gu,b.wd,b.sr]}),u})()},6524:(N,Z,r)=>{r.d(Z,{O:()=>P});var t=r(7582),g=r(520);const b=(0,r(7423).fo)("Network",{web:()=>r.e(4203).then(r.bind(r,4203)).then(u=>new u.NetworkWeb)});var y=r(4893),I=r(2468),e=r(6501);let x="https://api.soeasyapp.com/",P=(()=>{class u{constructor(a,c,d){this.http=a,this.dataservice=c,this.common=d,this.checkInternetConnection()}initiatePayment(a,c){const d={headers:(new g.WM).set("Content-Type","application/json").set("Authorization","PAY46ZGYME1AE6LUR1AVI1701862757.YFGJ11SECKEY")};return new Promise((A,T)=>{this.http.post("https://admin.payomatix.com/payment/merchant/"+c,JSON.stringify(a),d).subscribe(m=>{A(m)},m=>{T(m),"HttpErrorResponse"==m.name&&("Unknown Error"==m.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==m.statusText?"Something Went Wrong...":m.statusText)),console.log("In Chatconnect provider : Error",m)})})}postData(a,c){const d={headers:(new g.WM).set("Content-Type","application/json")};return new Promise((A,T)=>{this.http.post(x+c,JSON.stringify(a),d).subscribe(m=>{A(m)},m=>{T(m),"HttpErrorResponse"==m.name&&("Unknown Error"==m.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==m.statusText?"Something Went Wrong...":m.statusText)),console.log("In Chatconnect provider : Error",m)})})}checkInternetConnection(){return(0,t.mG)(this,void 0,void 0,function*(){(yield b.getStatus()).connected?console.log("Internet is connected"):(console.log("No internet connection"),this.common.presentToast("","Check your internet connection"))})}postFormData(a,c){return new Promise((d,A)=>{const T=(new g.WM).set("Accept","application/json");this.http.post(x+c,a,{headers:T}).subscribe(m=>{d(m)},m=>{A(m)})})}}return u.\u0275fac=function(a){return new(a||u)(y.LFG(g.eN),y.LFG(I.D),y.LFG(e.v))},u.\u0275prov=y.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);