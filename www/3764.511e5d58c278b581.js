"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3764],{5789:(A,M,o)=>{o.d(M,{zB:()=>s});const s=(0,o(7423).fo)("Contacts",{web:()=>o.e(627).then(o.bind(o,627)).then(h=>new h.ContactsWeb)})},3764:(A,M,o)=>{o.d(M,{M:()=>E});var _=o(7582),s=o(5789),h=o(7423),b=o(3919),t=o(4893),c=o(8058),u=o(2561),x=o(6501),C=o(6524),O=o(2468),g=o(9808);function I(n,P){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getContacts())}),t.TgZ(2,"div"),t._UZ(3,"ion-icon",11),t.TgZ(4,"div")(5,"ion-label"),t._uU(6,"Tap to sync contacts"),t.qZA()()()(),t.BQk()}}function m(n,P){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",12)(2,"ion-text")(3,"h3"),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA()()(),t.TgZ(7,"ion-checkbox",13),t.NdJ("ionChange",function(i){t.CHM(e);const l=t.oxw().$implicit,r=t.oxw();return t.KtG(r.checkboxClick(i,l))}),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Oqu(e.phone_number),t.xp6(1),t.Q6J("checked",e.checked)}}function v(n,P){if(1&n&&(t.ynx(0),t.YNc(1,m,8,3,"ion-item",4),t.BQk()),2&n){const e=P.$implicit;t.xp6(1),t.Q6J("ngIf",e.checked)}}function f(n,P){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",12)(2,"ion-text")(3,"h3"),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA()()(),t.TgZ(7,"ion-checkbox",13),t.NdJ("ionChange",function(i){t.CHM(e);const l=t.oxw().$implicit,r=t.oxw();return t.KtG(r.checkboxClick(i,l))}),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Oqu(e.phone_number),t.xp6(1),t.Q6J("checked",e.checked)}}function T(n,P){if(1&n&&(t.ynx(0),t.YNc(1,f,8,3,"ion-item",4),t.BQk()),2&n){const e=P.$implicit;t.xp6(1),t.Q6J("ngIf",!e.checked)}}let E=(()=>{class n{constructor(e,a,i,l,r,p,d,D){this.modalController=e,this.router=a,this.common=i,this.loadingController=l,this.chatconnect=r,this.navCtrl=p,this.dataservice=d,this.alertController=D,this.filterData=[],this.contacts=[],this.permissionGranted=!1,this.totalCheckedCount=0}presentAlert(){return(0,_.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Allow 'Contact Access' to access your contacts while you are using the app",buttons:[{text:"Don't Allow",cssClass:"alert-button"},{text:"Allow",cssClass:"alert-button",handler:()=>{console.log("Confirm Cancel: blah"),this.getPermissions()}}]})).present()})}getPermissions(){return(0,_.mG)(this,void 0,void 0,function*(){if(h.dV.isNativePlatform())return{granted:"granted"===(yield s.zB.requestPermissions()).contacts}})}ngOnInit(){console.log("This is First Count=>",this.totalCheckedCount),console.log("This is event Data ==> ",this.dataservice.user_event_data),console.log("Event data",this.dataservice.events_form);const e=localStorage.getItem("cust_contacts");if(null!==e){var a=JSON.parse(e);this.dataservice.ValidateArray(a)&&(this.filterData=a,this.dataservice.all_contacts=a,this.permissionGranted=!0)}}checkboxClick(e,a){console.log(e.detail),console.log(name,a),a.checked=!a.checked}closeModal(){return(0,_.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss({dismissed:!0})})}GoNext(){this.SubmitEvent()}SubmitEvent(){const e=this.dataservice.getUserData(),a=this.dataservice.GetAccountuser();this.common.show("Please wait, we are sending invites to your selected contact list...");var i=new FormData;null!==e&&i.append("user_token",e),i.append("type","2"),i.append("account_id",a),i.append("event_food_type",JSON.stringify(this.dataservice.event_food_type)),i.append("event_cusine_type",JSON.stringify(this.dataservice.event_cusine_type));const l=localStorage.getItem("event_images");null!==l&&!this.dataservice.isNullOrUndefined(l)&&i.append("event_images",this.dataservice.convertBase64ToBlob(l)),this.dataservice.foodImages.forEach(r=>{i.append("menu_imgData[]",r)}),i.append("events_data",JSON.stringify(this.dataservice.events_form)),i.append("guest_contacts",JSON.stringify(this.dataservice.all_contacts.filter(r=>r.checked))),console.log(i),this.chatconnect.postFormData(i,"create_paid_event").then(r=>{this.common.hide(),1==r.Response.status?(this.OpenSuccess(r.Response.token_url),this.common.presentToast("",r.Response.message),localStorage.removeItem("event_images")):this.common.presentToast("Oops",r.Response.message)},r=>{this.common.hide(),console.log("Connection failed Messge")})}OpenSuccess(e){return(0,_.mG)(this,void 0,void 0,function*(){console.log("Modal Open Event Created"),this.dataservice.shareable_event_url=e;const a=yield this.modalController.create({component:b.$,cssClass:"pindialog-container",handle:!0});return a.onDidDismiss().then(i=>{console.log("DATA HERE ---\x3e",i),null!=i.data&&this.dataservice.shareable_event_url&&this.closeModal()}),yield a.present()})}filterItems(e){console.log(e.detail.value),console.log(e.detail.value.length),this.dataservice.isNullOrUndefined(e.detail.value)||(this.filterData=this.dataservice.all_contacts.filter(a=>a.name.toLowerCase().indexOf(e.detail.value.toLowerCase())>-1||a.phone_number.toLowerCase().indexOf(e.detail.value.toLowerCase())>-1))}getContacts(){return(0,_.mG)(this,void 0,void 0,function*(){yield s.zB.requestPermissions().then(e=>(0,_.mG)(this,void 0,void 0,function*(){console.log("PERMISSONS RRESp ===>",e),"granted"==e.contacts&&(this.permissionGranted=!0,console.log("below granted  RRESp ===>"),this.loadingController.create({spinner:"lines",message:"Retrieving your contacts. This may take some time. Please wait...",cssClass:"custom-loading",backdropDismiss:!1}).then(a=>(0,_.mG)(this,void 0,void 0,function*(){a.present();var i=JSON.parse(localStorage.getItem("cust_contacts")||"null");if(console.log(i),console.log("retrievedObject ===>",i),this.dataservice.ValidateArray(i)){const l={name:!0,phones:!0};console.log("ABOVE AWAIT contact ===>"),yield s.zB.getContacts({projection:l}).then(r=>(0,_.mG)(this,void 0,void 0,function*(){console.log("MY CONTACTS ==>",r),yield r.contacts.forEach((d,D)=>{if(console.log(d),d.name&&d.name.display&&d.phones)for(let y=0;y<d.phones.length;y++)d.phones[y].number.length>9&&this.contacts.push({name:d.name.display,phone_number:d.phones[y].number.replace(/\D/g,"").slice(-10)});this.contacts.sort((y,S)=>this.compareObjects(y,S,"name"))});const p=[];this.contacts.forEach(d=>{p.some(D=>D.phone_number===d.phone_number)||p.push(d)}),console.log(p),localStorage.setItem("cust_contacts",JSON.stringify(p)),this.dataservice.all_contacts=p,console.log("ASSIGN CONAT CFILTER DAAS "),this.filterData=p,console.log("ASSIGN CONAT CFILTER DAAS ",this.filterData),console.log(this.dataservice.all_contacts),a.dismiss()}))}else this.dataservice.all_contacts=i,this.filterData=i,console.log(this.dataservice.all_contacts),a.dismiss()})))}))})}compareObjects(e,a,i){var l,r;let p=null===(l=e[i])||void 0===l?void 0:l.toUpperCase(),d=null===(r=a[i])||void 0===r?void 0:r.toUpperCase();return p<d?-1:p>d?1:0}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.IN),t.Y36(u.F0),t.Y36(x.v),t.Y36(c.HT),t.Y36(C.O),t.Y36(c.SH),t.Y36(O.D),t.Y36(c.Br))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-contact"]],decls:17,vars:3,consts:[["slot","start"],[3,"click"],["slot","end","name","close"],[1,"ion-no-padding",3,"ionChange"],[4,"ngIf"],[1,"container"],[4,"ngFor","ngForOf"],[1,"ion-no-border"],[1,"action-button"],["color","secondary","shape","round",1,"right",3,"click"],[1,"ion-padding-start","ion-padding-end","share-container",3,"click"],["name","share-outline"],[1,"ion-text-wrap"],["slot","end",3,"checked","ionChange"]],template:function(e,a){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return a.closeModal()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Contacts"),t.qZA()(),t.TgZ(7,"ion-searchbar",3),t.NdJ("ionChange",function(l){return a.filterItems(l)}),t.qZA()(),t.TgZ(8,"ion-content"),t.YNc(9,I,7,0,"ng-container",4),t.TgZ(10,"div",5),t.YNc(11,v,2,1,"ng-container",6),t.YNc(12,T,2,1,"ng-container",6),t.qZA()(),t.TgZ(13,"ion-footer",7)(14,"div",8)(15,"ion-button",9),t.NdJ("click",function(){return a.GoNext()}),t._uU(16,"Invite"),t.qZA()()()),2&e&&(t.xp6(9),t.Q6J("ngIf",!a.permissionGranted),t.xp6(2),t.Q6J("ngForOf",a.filterData),t.xp6(1),t.Q6J("ngForOf",a.filterData))},dependencies:[g.sg,g.O5,c.YG,c.Sm,c.nz,c.W2,c.fr,c.Gu,c.gu,c.Ie,c.Q$,c.VI,c.yW,c.wd,c.sr,c.w,c.j9],styles:[".toolbar-container[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center}ion-title[_ngcontent-%COMP%]{text-align:center;position:absolute;inset:0}ion-header[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{margin:5px auto;width:95%}.share-container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%;align-items:center}.share-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:81px;width:100%}.list-container[_ngcontent-%COMP%]{border:2px solid black;height:50vh;margin:10px}.action-button-container[_ngcontent-%COMP%]{text-align:center}.action-button-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:var(--ion-color-light);width:50%;height:40px;font-size:1em;margin-top:1em}.right[_ngcontent-%COMP%]{display:flex;justify-content:center;max-width:181px;margin:10px auto;font-size:16px}ion-footer[_ngcontent-%COMP%]{border-radius:25px 25px 0 0;box-shadow:2px 2px 2px 2px gray}ion-footer[_ngcontent-%COMP%]   .csv_style[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;padding:18px 0}ion-footer[_ngcontent-%COMP%]   .csv_style[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:grid}ion-footer[_ngcontent-%COMP%]   .csv_style[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px;background:#e9e9e9;border-radius:100%;margin:auto;padding:10px}"]}),n})()},3919:(A,M,o)=>{o.d(M,{$:()=>c});var _=o(7582),s=o(4893),h=o(8058),b=o(2561),t=o(2468);let c=(()=>{class u{constructor(C,O,g){this.modalController=C,this.router=O,this.dataservice=g}ngOnInit(){}closeModal(){return(0,_.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss({dismissed:!0}),this.router.navigate("community"==this.dataservice.community_event_or_not?["/buztabs/dashboard"]:["/buztabs/map"])})}}return u.\u0275fac=function(C){return new(C||u)(s.Y36(h.IN),s.Y36(b.F0),s.Y36(t.D))},u.\u0275cmp=s.Xpm({type:u,selectors:[["app-create-perm"]],decls:12,vars:0,consts:[["slot","start"],[3,"click"],["slot","end","name","close"],[1,"ion-padding"],[1,"contianer"],["src","assets/images/congratulation.png"],[1,"text"],[1,"foot"],["expand","block","color","secondary",3,"click"]],template:function(C,O){1&C&&(s.TgZ(0,"ion-buttons",0)(1,"ion-button",1),s.NdJ("click",function(){return O.closeModal()}),s._UZ(2,"ion-icon",2),s.qZA()(),s.TgZ(3,"ion-content",3)(4,"div",4),s._UZ(5,"ion-img",5),s.TgZ(6,"div",6)(7,"p"),s._uU(8,"Event creation complete!"),s.qZA()(),s.TgZ(9,"div",7)(10,"ion-button",8),s.NdJ("click",function(){return O.closeModal()}),s._uU(11,"Close"),s.qZA()()()())},dependencies:[h.YG,h.Sm,h.W2,h.gu,h.Xz],styles:["ion-icon[_ngcontent-%COMP%]{font-size:1.4rem}.contianer[_ngcontent-%COMP%]{position:relative;top:10%}.contianer[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;height:40vh;border-radius:20px;margin:auto}.contianer[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.contianer[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;font-weight:bolder}.contianer[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem}.contianer[_ngcontent-%COMP%]   .foot[_ngcontent-%COMP%]{margin-top:40px;text-align:center}.contianer[_ngcontent-%COMP%]   .foot[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{background:var(--ion-color-dark);padding:7px;margin-left:10px;border-radius:50%}.contianer[_ngcontent-%COMP%]   .foot[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{max-width:250px;margin:40px auto auto;height:40px}"]}),u})()},6524:(A,M,o)=>{o.d(M,{O:()=>O});var _=o(7582),s=o(520);const b=(0,o(7423).fo)("Network",{web:()=>o.e(4203).then(o.bind(o,4203)).then(g=>new g.NetworkWeb)});var t=o(4893),c=o(2468),u=o(6501);let x="https://api.soeasyapp.com/",O=(()=>{class g{constructor(m,v,f){this.http=m,this.dataservice=v,this.common=f,this.checkInternetConnection()}initiatePayment(m,v){const f={headers:(new s.WM).set("Content-Type","application/json").set("Authorization","PAY46ZGYME1AE6LUR1AVI1701862757.YFGJ11SECKEY")};return new Promise((T,E)=>{this.http.post("https://admin.payomatix.com/payment/merchant/"+v,JSON.stringify(m),f).subscribe(n=>{T(n)},n=>{E(n),"HttpErrorResponse"==n.name&&("Unknown Error"==n.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==n.statusText?"Something Went Wrong...":n.statusText)),console.log("In Chatconnect provider : Error",n)})})}postData(m,v){const f={headers:(new s.WM).set("Content-Type","application/json")};return new Promise((T,E)=>{this.http.post(x+v,JSON.stringify(m),f).subscribe(n=>{T(n)},n=>{E(n),"HttpErrorResponse"==n.name&&("Unknown Error"==n.statusText?this.checkInternetConnection():this.common.presentToast("","OK"==n.statusText?"Something Went Wrong...":n.statusText)),console.log("In Chatconnect provider : Error",n)})})}checkInternetConnection(){return(0,_.mG)(this,void 0,void 0,function*(){(yield b.getStatus()).connected?console.log("Internet is connected"):(console.log("No internet connection"),this.common.presentToast("","Check your internet connection"))})}postFormData(m,v){return new Promise((f,T)=>{const E=(new s.WM).set("Accept","application/json");this.http.post(x+v,m,{headers:E}).subscribe(n=>{f(n)},n=>{T(n)})})}}return g.\u0275fac=function(m){return new(m||g)(t.LFG(s.eN),t.LFG(c.D),t.LFG(u.v))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);